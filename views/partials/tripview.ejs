<style>
  tr.hide-table-padding td {
  padding: 0;
}

.expand-button {
	position: relative;
}

.accordion-toggle .expand-button:after
{
  position: absolute;
  left:.75rem;
  top: 50%;
  transform: translate(0, -50%);
  content: '-';
}
.accordion-toggle.collapsed .expand-button:after
{
  content: '+';
}

#tdcard {
  margin-top: 10px;
  margin-bottom: 10px;
}

#tow-card {
  margin-top: 10px;
  margin-bottom: 10px;
  background-color: #686a6e;
}

#cardtitle {
  margin-bottom: 0px;
}

.table-responsive {
  margin-top: 10px;
}

.card-body {
  padding: 10px;
}

.horizontal-line {
  padding-left: 10px;
  padding-right: 10px;
}

.hr-line-line {
  margin: 1px;
  border: 1px solid #F0F8FF;
}

.tow-row {
  font-size: 80%;
}


</style>

 <div class="table-responsive">
  <table class="table table-hover table-sm" data-toggle="table">
    <thead>
      <tr>
        <th data-field="order_id" data-sortable="true" scope="col">Job Number</th>
        <th data-sortable="true" scope="col">Status</th>
        <th data-sortable="true" scope="col">Customer Name</th>
        <th data-sortable="true" scope="col">Origin Location</th>
        <th data-sortable="true" scope="col">Destination Location</th>
        <th scope="col">#</th>
      </tr>
    </thead>
    <tbody>
      <% for (let i = 0; i < jobs.length; i++) { %>
      <tr class="accordion-toggle collapsed" id="accordion1" data-toggle="collapse" data-parent="#accordion1" href="#<%= jobs[i].ordnbr %>">
        <td><%= jobs[i].ordnbr %></td>
        <td><%= jobs[i].status %></td>
        <td><%= jobs[i].customer_nm %></td>
        <td><%= jobs[i].origin_location %></td>
        <td><%= jobs[i].dest_location %></td>
        <td class="expand-button"></td>
        </tr>
          
  <tr class="hide-table-padding">
  <td colspan="6">
  <div class="collapse in col-sm head-div" id="<%= jobs[i].ordnbr %>">
    <div class="card" id="tdcard">
      <div class="card-body">
        <div class="row">
        <h5 class="card-title col align-self-center" id="cardtitle"><%= jobs[i].ordnbr %> - <%= jobs[i].customer_nm %></h5>
        <button type="button" class="btn col-1" id="edittripbutton" data-toggle="modal" data-target="#e<%= jobs[i].ordnbr %>">Edit</button>
        <button type="button" class="btn col-1" data-toggle="modal" data-target="#d<%= jobs[i].ordnbr %>">Delete</button>
      </div>

      <!-- Edit Job Modal -->
      <div class="modal fade" id="e<%= jobs[i].ordnbr %>" tabindex="-1" role="dialog" aria-labelledby="editTripModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="editTripModalLabel">Edit Order Details</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <!-- Edit Job Form Begin -->
              <form class="edittripform">
                <h5>Order Information</h5>
                <div class="row">
                    <div class="col-4">
                        <div class="form-group">
                            <label hidden for="eid"></label>
                            <input hidden type="text" class="form-control" id="eid" placeholder="Order #" value="<%= jobs[i].order_id %>">
                            <label for="eorderNumberInput">Order #</label>
                            <input type="text" class="form-control" id="eorderNumberInput" placeholder="Order #" value="<%= jobs[i].ordnbr %>" readonly>
                        </div>
                    </div>
                    <div class="col-4">
                      <div class="form-group">
                          <label for="ecustomerNameInput">Customer Name</label>
                          <input type="text" class="form-control" id="ecustomerNameInput" placeholder="Customer Name" value="<%= jobs[i].customer_nm %>">
                      </div>
                  </div>
                      <div class="col-4">
                          <div class="form-group">
                              <label for="eOriginInput">Origin Location</label>
                              <input type="text" class="form-control" id="eOriginInput" placeholder="Origin" value="<%= jobs[i].origin_location %>">
                          </div>
                  </div>
              </div>
              <div class="row">
                <div class="col-4">
                    <div class="form-group">
                        <label for="eOriginDescription">Origin Description</label>
                        <input type="text" class="form-control" id="eOriginDescription" placeholder="Origin Description" value="<%= jobs[i].origin_desc %>">
                    </div>
                </div>
                <div class="col-4">
                  <div class="form-group">
                      <label for="eDestinationInput">Destination Location</label>
                      <input type="text" class="form-control" id="eDestinationInput" placeholder="Destination Location" value="<%= jobs[i].dest_location %>">
                  </div>
              </div>
                  <div class="col-4">
                      <div class="form-group">
                          <label for="eDestinationDescription">Destination Description</label>
                          <input type="text" class="form-control" id="eDestinationDescription" placeholder="Destination" value="<%= jobs[i].dest_desc %>">
                      </div>
              </div>
          </div>
                  <div class="row">
                      <div class="col-12">
                          <div class="form-group editable">
                              <label for="eOrderNotes">Order Notes</label>
                              <input type="text" class="form-control" id="eOrderNotes" placeholder="Order Notes" value="<%= jobs[i].ord_notes %>">
                          </div>
                      </div>
                </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
            <!-- End Job Form End -->
          </div>
        </div>
      </div>
      <!-- Edit Job Modal End -->

      <!-- Delete Job Modal -->
      <div class="modal fade" id="d<%= jobs[i].ordnbr %>" tabindex="-1" role="dialog" aria-labelledby="deleteTripModalLable" aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Are you sure you want to delete job <%= jobs[i].ordnbr %>? </h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              Click DELETE to delete this job, or click Close to dismiss.
              <form class="deletetripform">
                <div class="form-group">
                  <label hidden for="did"></label>
                  <input hidden type="text" class="form-control" id="did" placeholder="Order #" value="<%= jobs[i].ordnbr %>">
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-danger">DELETE THIS JOB</button>
            </div>
          </form>
          </div>
        </div>
      </div>
      <!-- Delete Trip Modal End -->

              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              </button>
      </div>
      <div class="horizontal-line">
        <hr class="hr-line-line">
      </div>
      <div class="modal-body">
        <div class="row">
          <div class="col-5"><h5>Trip Details</h5></div>
          <div class="col-5"><h5>Tow Details</h5></div>
          <div class="col-2"style="text-align:right"><button class="btn btn-secondary btn-sm" data-toggle="modal" data-target="#newTowModal">New Tow</button></div>
          
        </div>
        
        <div class="row">
        <div class="col-2">
          Trip #:
          <br>
          Customer:
          <br>
          Origin:
          <br>
          Origin Details:
          <br>
          Destination:
          <br>
          Destination Details:
          <br>
          Trip Notes:
      </div>
      <div class="col-3">
          <%= jobs[i].ordnbr %>
          <br>
          <%= jobs[i].customer_nm %>
          <br>
          <%= jobs[i].origin_location %>
          <br>
          <%= jobs[i].origin_desc %>
          <br>
          <%= jobs[i].dest_location %>
          <br>
          <%= jobs[i].dest_desc %>
          <br>
          <%= jobs[i].ord_notes %>
      </div>
        <div class="col-7">
          <% for (let j = 0; j < tows.length; j++) { %>
            <% if (tows[j].ordnbr === jobs[i].ordnbr) { %>
                  <div class="card" id="tow-card">
                    <div class="card-body">
                    <div class="row">
                      <div class="col-2">
                      Tow ID:
                    </div>
                    <div class="col-4">
                      <%= tows[j].tow_id %>
                    </div>
                    <div class="col-4">
                    </div>
                    <div class="col-2" style="text-align:right">
                      <button type="button" class="btn btn-sm" id="edittowbutton" data-toggle="modal" data-target="#e<%= tows[j].tow_id %>">Edit</button>
                    </div>
                  </div>
      <!-- Edit Tow Modal -->
      <div class="modal fade" id="e<%= tows[j].tow_id %>" tabindex="-1" role="dialog" aria-labelledby="editTowModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="editTowModalLabel">Edit Tow Details</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <!-- Edit Tow Form Begin -->
              <form class="edittowform">
                <h5>Barge Information</h5>
                <div class="row">
                    <div class="col-2">
                        <div class="form-group">
                            <label hidden for="eid"></label>
                            <input hidden type="text" class="form-control" id="eid" placeholder="Order #" value="<%= tows[j].tow_id %>">
                            <label for="eBarge1NameInput">Barge 1 Name:</label>
                            <input type="text" class="form-control" id="eBarge1NameInput" placeholder="Barge Name" value="<%= tows[j].barge_1_name %>">
                        </div>
                    </div>
                    <div class="col-2">
                      <div class="form-group">
                      <label for="eBarge1Start">Barge 1 Start:</label>
                      <input type="text" id="eBarge1Start" class="form-control datetimepicker" value="<%= tows[j].barge_1_start %>" />
                    </div>
                  </div>
                  <div class="col-2">
                    <div class="form-group">
                    <label for="eBarge1Stop">Barge 1 Stop:</label>
                    <input type="text" id="eBarge1Stop" class="form-control datetimepicker" value="<%= tows[j].barge_1_stop %>" />
                  </div>
                </div>
                <div class="col-2">
                  <div class="form-group">
                  <label for="eBarge1Loc">Barge 1 Location:</label>
                  <input type="text" id="eBarge1Loc" class="form-control" value="LM-100" />
                </div>
              </div>
              <div class="col-2">
                <div class="form-group">
                <label for="eBarge1Coord">Barge 1 Coordinates:</label>
                <input type="text" id="eBarge1Coord" class="form-control" value="29.952368, -90.224134" />
              </div>
            </div>
            <div class="col-2">
              <div class="form-group">
              <label for="eBarge1Inherit">Inherit Location From:</label>
              <input type="text" id="eBarge1Inherit" class="form-control" value="..." />
            </div>
          </div>
        </div>
                  <div class="row">
                    <div class="col-2">
                        <div class="form-group">
                            <label for="eBarge2NameInput">Barge 2 Name:</label>
                            <input type="text" class="form-control" id="eBarge2NameInput" placeholder="Barge Name" value="<%= tows[j].barge_2_name %>">
                        </div>
                    </div>
                    <div class="col-2">
                      <div class="form-group">
                      <label for="eBarge2Start">Barge 2 Start:</label>
                      <input type="text" id="eBarge2Start" class="form-control datetimepicker" value="<%= tows[j].barge_2_start %>" />
                    </div>
                  </div>
                  <div class="col-2">
                    <div class="form-group">
                    <label for="eBarge2Stop">Barge 2 Stop:</label>
                    <input type="text" id="eBarge2Stop" class="form-control datetimepicker" value="<%= tows[j].barge_2_stop %>" />
                  </div>
                </div>
                <div class="col-2">
                  <div class="form-group">
                  <label for="eBarge2Loc">Barge 2 Location:</label>
                  <input type="text" id="eBarge2Loc" class="form-control" value="LM-100" />
                </div>
              </div>
              <div class="col-2">
                <div class="form-group">
                <label for="eBarge2Coord">Barge 2 Coordinates:</label>
                <input type="text" id="eBarge2Coord" class="form-control" value="29.952368, -90.224134" />
              </div>
            </div>
            <div class="col-2">
              <div class="form-group">
              <label for="eBarge2Inherit">Inherit Location From:</label>
              <input type="text" id="eBarge2Inherit" class="form-control" value="..." />
            </div>
          </div>
          </div>
              <div class="row">
                <div class="col-2">
                    <div class="form-group">
                        <label for="eBarge3NameInput">Barge 3 Name:</label>
                        <input type="text" class="form-control" id="eBarge3NameInput" placeholder="Barge Name" value="<%= tows[j].barge_3_name %>">
                    </div>
                </div>
                <div class="col-2">
                  <div class="form-group">
                  <label for="eBarge3Start">Barge 3 Start:</label>
                  <input type="text" id="eBarge3Start" class="form-control datetimepicker" value="<%= tows[j].barge_3_start %>" />
                </div>
              </div>
              <div class="col-2">
                <div class="form-group">
                <label for="eBarge3Stop">Barge 3 Stop:</label>
                <input type="text" id="eBarge3Stop" class="form-control datetimepicker" value="<%= tows[j].barge_3_stop %>" />
              </div>
            </div>
            <div class="col-2">
              <div class="form-group">
              <label for="eBarge3Loc">Barge 3 Location:</label>
              <input type="text" id="eBarge3Loc" class="form-control" value="LM-100" />
            </div>
            </div>
            <div class="col-2">
            <div class="form-group">
            <label for="eBarge3Coord">Barge 3 Coordinates:</label>
            <input type="text" id="eBarge3Coord" class="form-control" value="29.952368, -90.224134" />
            </div>
            </div>
            <div class="col-2">
              <div class="form-group">
              <label for="eBarge3Inherit">Inherit Location From:</label>
              <input type="text" id="eBarge3Inherit" class="form-control" value="..." />
            </div>
          </div>
          </div>
          <h5>Tug Information</h5>
                <div class="row">
                            <div class="col-2">
                                <div class="form-group">
                                    <label for="eTug1NameInput">Tug 1 Name:</label>
                                    <input type="text" class="form-control" id="eTug1NameInput" placeholder="Tug Name" value="<%= tows[j].tug_1_name %>">
                                </div>
                            </div>
                            <div class="col-2">
                              <div class="form-group">
                              <label for="eTug1Start">Tug 1 Start:</label>
                              <input type="text" id="eTug1Start" class="form-control datetimepicker" value="<%= tows[j].tug_1_start %>" />
                            </div>
                          </div>
                          <div class="col-2">
                            <div class="form-group">
                            <label for="eTug1Stop">Tug 1 Stop:</label>
                            <input type="text" id="eTug1Stop" class="form-control datetimepicker" value="<%= tows[j].tug_1_stop %>" />
                          </div>
                        </div>
                        <div class="col-2">
                          <div class="form-group">
                          <label for="eTug1Loc">Tug 1 Location:</label>
                          <input type="text" id="eTug1Loc" class="form-control" value="LM-100" />
                        </div>
                        </div>
                        <div class="col-2">
                        <div class="form-group">
                        <label for="eTug1Coord">Tug 1 Coordinates:</label>
                        <input type="text" id="eTug1Coord" class="form-control" value="29.952368, -90.224134" />
                        </div>
                        </div>
                </div>
                <div class="row">
                              <div class="col-2">
                                <div class="form-group">
                                    <label for="eTug2NameInput">Tug 2 Name:</label>
                                    <input type="text" class="form-control" id="eTug2NameInput" placeholder="Tug Name" value="<%= tows[j].tug_2_name %>">
                                </div>
                            </div>
                            <div class="col-2">
                              <div class="form-group">
                              <label for="eTug2Start">Tug 2 Start:</label>
                              <input type="text" id="eTug2Start" class="form-control datetimepicker" value="<%= tows[j].tug_2_start %>" />
                            </div>
                          </div>
                          <div class="col-2">
                            <div class="form-group">
                            <label for="eTug2Stop">Tug 2 Stop:</label>
                            <input type="text" id="eTug2Stop" class="form-control datetimepicker" value="<%= tows[j].tug_2_stop %>" />
                          </div>
                        </div>
                        <div class="col-2">
                          <div class="form-group">
                          <label for="eTug2Loc">Tug 2 Location:</label>
                          <input type="text" id="eTug2Loc" class="form-control" value="LM-100" />
                        </div>
                        </div>
                        <div class="col-2">
                        <div class="form-group">
                        <label for="eTug2Coord">Tug 2 Coordinates:</label>
                        <input type="text" id="eTug2Coord" class="form-control" value="29.952368, -90.224134" />
                        </div>
                        </div>
                        <div class="col-2">
                          <div class="form-group">
                          <label for="eTug2Inherit">Inherit Location From:</label>
                          <input type="text" id="eTug2Inherit" class="form-control" value="..." />
                        </div>
                      </div>
               </div>
                <div class="row">
                          <div class="col-2">
                            <div class="form-group">
                                <label for="eTug3NameInput">Tug 3 Name:</label>
                                <input type="text" class="form-control" id="eTug3NameInput" placeholder="Tug Name" value="<%= tows[j].tug_3_name %>">
                            </div>
                        </div>
                        <div class="col-2">
                          <div class="form-group">
                          <label for="eTug3Start">Tug 3 Start:</label>
                          <input type="text" id="eTug3Start" class="form-control datetimepicker" value="<%= tows[j].tug_3_start %>" />
                        </div>
                      </div>
                      <div class="col-2">
                        <div class="form-group">
                        <label for="eTug3Stop">Tug 3 Stop:</label>
                        <input type="text" id="eTug3Stop" class="form-control datetimepicker" value="<%= tows[j].tug_3_stop %>" />
                      </div>
                    </div>
                    <div class="col-2">
                      <div class="form-group">
                      <label for="eTug3Loc">Tug 3 Location:</label>
                      <input type="text" id="eTug3Loc" class="form-control" value="LM-100" />
                    </div>
                    </div>
                    <div class="col-2">
                    <div class="form-group">
                    <label for="eTug3Coord">Tug 3 Coordinates:</label>
                    <input type="text" id="eTug3Coord" class="form-control" value="29.952368, -90.224134" />
                    </div>
                    </div>
                    <div class="col-2">
                      <div class="form-group">
                      <label for="eTug3Inherit">Inherit Location From:</label>
                      <input type="text" id="eTug3Inherit" class="form-control" value="..." />
                    </div>
                  </div>
               </div>
              </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  <button type="submit" class="btn btn-primary">Save Changes</button>
                </div>
            </form>
          </div>
        </div>
      </div>
      <!-- Edit Job Modal End -->
                    
      <table class="table tow-row">
        <thead>
          <tr>
            <td>Asset</td>
            <td>Location</td>
            <td>Coordinates</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="tow-col"><%= tows[j].barge_1_name %></td>
            <td>LM - 400</td>
            <td>29.952368, -90.224134</td>
          </tr>
          <tr>
            <td class="tow-col"><%= tows[j].barge_2_name %></td>
            <td>LM - 400</td>
            <td>29.952368, -90.224134</td>
          </tr>
          <tr>
            <td class="tow-col"><%= tows[j].barge_3_name %></td>
            <td>LM - 400</td>
            <td>29.952368, -90.224134</td>
          </tr>
          <tr>
            <td class="tow-col"><%= tows[j].boat_1_name %></td>
            <td>LM - 400</td>
            <td>29.952368, -90.224134</td>
          </tr>
          <tr>
            <td class="tow-col"><%= tows[j].boat_2_name %></td>
            <td>LM - 400</td>
            <td>29.952368, -90.224134</td>
          </tr>
          <tr>
            <td class="tow-col"><%= tows[j].boat_3_name %></td>
            <td>LM - 400</td>
            <td>29.952368, -90.224134</td>
          </tr>
        </tbody>
      </table>
                    <!-- <div class="row tow-row">
                      <div class="col-2">
                      Barge 1:
                    </div>
                    <div class="col-4 tow-col">
                      <%= tows[j].barge_1_name %>
                    </div>
                    </div>
                    <div class="row tow-row">
                      <div class="col-2">
                      Barge 2:
                    </div>
                    <div class="col-4 tow-col">
                      <%= tows[j].barge_2_name %>
                    </div>
                    </div>
                    <div class="row tow-row">
                      <div class="col-2">
                      Barge 3:
                    </div>
                    <div class="col-4 tow-col">
                      <%= tows[j].barge_3_name %>
                    </div>
                    </div>
                    <div class="row tow-row">
                      <div class="col-2">
                      Tug 1:
                    </div>
                    <div class="col-4 tow-col">
                      <%= tows[j].boat_1_name %>
                    </div>
                    </div>
                    <div class="row tow-row">
                      <div class="col-2">
                      Tug 2:
                    </div>
                    <div class="col-4 tow-col">
                      <%= tows[j].boat_2_name %>
                    </div>
                    </div>
                    <div class="row tow-row">
                      <div class="col-2">
                      Tug 3:
                    </div>
                    <div class="col-4 tow-col">
                      <%= tows[j].boat_3_name %>
                    </div>
                    </div> -->
                  </div>
                  </div>
            <% } %>
            <% } %>
        </div>
      </div>
      </div>
  </div>
  </div></td>
  </tr>
  <% } %>
      </tbody>
    </table>
  </div>
  